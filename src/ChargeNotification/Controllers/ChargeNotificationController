using System.Diagnostics;
using Microsoft.AspNetCore.Mvc;
using ChargeNotification.Models;
using ChargeNotification.Data;

namespace ChargeNotification.Controllers;

public class NotificationController : Controller
{
    private readonly ApplicationDbContext Context;

    public NotificationController(ApplicationDbContext context)
    {
        this.Context = context;
    }

    public IActionResult Index()
    {
        return View();
    }

    public IActionResult Detail(int id)
    {
        Customer? customer = this.Context.Customers.First(i => i.Id == id);
        if (customer == null)
        {
            return NotFound();
        }
        List<GameCharge> charges = this.Context.GameCharges.Find(i => i.CustomerId == id).ToList();
        Notification notification = new() 
        {
            CustomerNumber = customer.Id,
            CustomerName = customer.Name,
            Charges = charges
        }
        return View(charges);
    }
}